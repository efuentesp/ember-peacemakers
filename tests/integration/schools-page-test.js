// Generated by CoffeeScript 1.6.3
import startApp from 'pm/tests/helpers/start-app';
var App, server;

App = null;

server = null;

module('Integration Test - Schools page', {
  setup: function() {
    var schools;
    console.log("setup");
    App = startApp();
    schools = [
      {
        id: 1,
        name: 'School 1',
        type: 'PUBLIC'
      }, {
        id: 2,
        name: 'School 2',
        type: 'PRIVATE'
      }, {
        id: 3,
        name: 'School 3',
        type: 'PRIVATE'
      }
    ];
    return server = new Pretender(function() {
      this.get('/api/schools', function(request) {
        return [
          200, {
            'Content-Type': 'application/json'
          }, JSON.stringify({
            schools: schools
          })
        ];
      });
      return this.get('/api/schools/:id', function(request) {
        var school;
        school = schools.find(function(school) {
          if (school.id === parseInt(request.params.id, 10)) {
            return school;
          }
        });
        return [
          200, {
            'Content-Type': 'application/json'
          }, JSON.stringify({
            school: school
          })
        ];
      });
    });
  },
  teardown: function() {
    Ember.run(App, 'destroy');
    return server.shutdown();
  }
});

test('Should navigate to Schools page', function() {
  return visit('/').then(function() {
    return click("a:contains('Escuelas')").then(function() {
      return equal(find('h2#title').text(), ' Escuelas');
    });
  });
});

test('Should list all schools', function() {
  return visit('/schools').then(function() {
    equal(find("td:contains('School 1')").length, 1);
    equal(find("td:contains('School 2')").length, 1);
    return equal(find("td:contains('School 3')").length, 1);
  });
});
