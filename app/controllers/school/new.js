// Generated by CoffeeScript 1.6.3
import Ember from 'ember';
import FormController from '../../mixins/form-controller';
var SchoolItemController;

SchoolItemController = Ember.ObjectController.extend(FormController, {
  newSchool: Ember.Object.create({
    name: '',
    type: '',
    city: '',
    state: ''
  }),
  schoolTypes: (function() {
    return this.store.find("school-type");
  }).property(),
  schoolStates: (function() {
    return this.store.find("state");
  }).property(),
  actions: {
    submit: function() {
      var isFormValid, school, schoolState, schoolType,
        _this = this;
      console.log("Sumbit!!");
      console.log(this.newSchool.name);
      console.log(this.newSchool.type);
      console.log(this.newSchool.city);
      console.log(this.newSchool.state);
      isFormValid = this.get('isFormValid');
      console.log(isFormValid);
      if (isFormValid) {
        schoolType = this.newSchool.type;
        schoolState = this.newSchool.state;
        school = this.store.createRecord('school', {
          name: this.newSchool.name,
          city: this.newSchool.city
        });
        school.save().then(function() {
          _this.store.find('school-type', schoolType).then(function(type) {
            return school.set('type', type);
          });
          return _this.store.find('state', schoolState).then(function(state) {
            return school.set('state', state);
          });
        });
        console.log(school);
        return this.transitionToRoute("schools");
      }
    },
    cancel: function() {
      console.log("Cancel!!");
      return this.transitionToRoute("schools");
    }
  }
});

export default SchoolItemController;
